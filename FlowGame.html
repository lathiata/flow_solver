<!DOCTYPE html>
<html>
	<head>
		<script src="jquery-1.11.3.js"></script>
		<meta charset="UTF-8">
		<title>Flow Game Solver</title>
	</head>

	<body>
		<div id="FlowInstructions"></div>
		<div id="FlowInstance" style="display:none;"></div>
		<div id="FlowParameters">
			Please select the number of colors your Flow instance has:
			<select id="numColors">
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5</option>
				<option value="6">6</option>
				<option value="7">7</option>
				<option value="8">8</option>
				<option value="9">9</option>
			</select>
			<br>
			Please select the size of the Flow instance grid:
			<select id="gridSize">
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5</option>
				<option value="6">6</option>
				<option value="7">7</option>
				<option value="8">8</option>
				<option value="9">9</option>
			</select>
			<br>
			<button id="generateButton" onclick="generateGrid()">Generate Grid</button>
		</div>
	</body>
</html>

<script>
	
	colors = ["resources/blue.jpg", "resources/gray.jpg", "resources/green.jpg", "resources/maroon.jpg", "resources/orange.jpg", "resources/pink.jpg", "resources/red.jpg", "resources/teal.jpg", "resources/yellow.jpg"];	

	function generateGrid() {
		//create 'object'
		instanceData = {instance: [], index: 0};
		console.log(instanceData);
		//get values
		var gridsize = $("#gridSize").val();
		numcolors = $("#numColors").val();

		//hide initial stuff
		$("#FlowParameters").hide()

		//generate the actual grid
		var table = "<table>";
		for (var i=0; i < gridsize; i++) {
			table += "<tr>";
			for (j=0; j < gridsize; j++) {
				table += "<td><button id='" + i + j + "' onclick='createInstance(" + i + "," + j + ")'><img src='resources/black.jpg' style='width:50px;height:50px'></button></td>";
			}
			table += "</tr>";
		}
		table += "</table>";
		table += "<br><br><button onclick='send()'>Submit</button>";
		$("#FlowInstructions").append("Currently placing <br> <img src='" + colors[0] + "' style='width:50px;height:50px'><br><br>");
		$("#FlowInstance").append(table);
		$("#FlowInstance").show();
	}

	function createInstance(i, j) {
		//look up jquery way
		if ((instanceData.index < 2*numcolors) && ($.inArray("(" + i + "," + j + ")", instanceData.instance) == -1)) {
			color = colors[Math.floor(instanceData.index/2)];
			if (Math.floor((instanceData.index+1)/2) < numcolors) {
				nextColor = colors[Math.floor((instanceData.index+1)/2)];
				$("#FlowInstructions").html("Currently placing <br> <img src='" + nextColor + "' style='width:50px;height:50px'><br><br>");
			} else {
				$("#FlowInstructions").html("Done placing - please submit");
			}
			var button = document.getElementById(i + "" + j);
			button.innerHTML = "<img src='" + color + "' style='width:50px;height:50px'>";
			instanceData.instance.push("(" + i + "," + j + ")");
			instanceData.index += 1;
			console.log(instanceData);
		}
	}

	function send() {
		var xhttp = new XMLHttpRequest();
		xhttp.open("GET", "http://127.0.0.1:5000//", true);
		xhttp.send();

		console.log(xhttp.status);
		console.log(xhttp.statusText);
	}
</script>